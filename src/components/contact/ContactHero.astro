---
import { Building2, Mail, Phone } from 'lucide-react'
import { CONTACT } from '@config'
import highlight from '@images/illustrations/underline-simple-light-purple.svg'
import { Image } from 'astro:assets'
---

<div
  class="relative min-h-screen w-full overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100"
>
  <!-- Background Pattern -->
  <div class="absolute inset-0 h-full w-full">
    <div
      class="absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:96px_96px]"
    >
    </div>
    <div
      class="bg-primary/5 absolute left-0 right-0 top-0 -z-10 m-auto h-[610px] w-[610px] rounded-full blur-[100px]"
    >
    </div>
    <div
      class="absolute inset-0 bg-gradient-to-t from-white via-white/80 to-transparent"
    >
    </div>
  </div>

  <!-- Main Content -->
  <div class="relative mx-auto max-w-7xl px-4 py-16 sm:px-6 sm:py-24 lg:px-8">
    <div class="grid gap-x-8 gap-y-16 py-16 lg:grid-cols-2 lg:gap-y-20">
      <!-- Left Column - Contact Info -->
      <div class="lg:pr-8">
        <h2 class="h1 mx-auto mt-6 max-w-3xl text-left text-purple-900">
        <span class="relative block">
          <span class="relative">
            <Image
              class="absolute inset-0 translate-y-9 transform sm:translate-y-11 xl:translate-y-14"
              src={highlight}
              alt=""
            />
            <span class="relative">BagelEdu</span>
          </span>
        </span>
      </h2>
        <p class="mt-6 text-lg leading-8 text-gray-600">
          에 대한 궁금증부터, 성적 향상 및 합격 가능성
          예상까지. 지금 바로 무료로 상담 받으세요.
        </p>
        <ul class="list-inside list-disc mt-6 space-y-2 text-md text-gray-900">
          <li>첫 30분 무료 상담</li>
          <li>유료 상담: 전화 혹은 zoom, 대면 상담 모두 30 이후 부터 1시간 5만원 상담비</li>
        </ul>
        <p class="mt-6 text-md leading-8 text-gray-600">
          (프로그램 질문에 대한 상담, 학교와의 fit, 합격 가능성, 진로 고민, 미국 학업 및 생활 등)
          * 상담 후 프로그램 계약 시, 상담비는 컨설팅비에 포함되어 환불됩니다.
        </p>
        <dl class="mt-10 space-y-4 text-base leading-7 text-gray-600">
          <div class="flex gap-x-4">
            <dt class="flex-none">
              <span class="sr-only">Address</span>
              <Building2 client:load className="h-7 w-6 text-gray-400" />
            </dt>
            <dd>
              {CONTACT.address}
            </dd>
          </div>
          <div class="flex gap-x-4">
            <dt class="flex-none">
              <span class="sr-only">Phone</span>
              <Phone client:load className="h-7 w-6 text-gray-400" />
            </dt>
            <dd>
              <a class="hover:text-gray-900" href="tel:+82-2-1234-5678">
                {CONTACT.phone}
              </a>
            </dd>
          </div>
          <div class="flex gap-x-4">
            <dt class="flex-none">
              <span class="sr-only">Email</span>
              <Mail client:load className="h-7 w-6 text-gray-400" />
            </dt>
            <dd>
              <a class="hover:text-gray-900" href="mailto:info@bageledu.com">
                {CONTACT.email}
              </a>
            </dd>
          </div>
        </dl>
      </div>

      <!-- Right Column - Contact Form -->
      <form
        id="contactForm"
        class="rounded-xl bg-white shadow-xl ring-1 ring-gray-200 sm:rounded-xl md:col-span-2 lg:col-span-1"
        enctype="multipart/form-data"
      >
        <div class="px-6 py-12 sm:p-12">
          <div class="grid grid-cols-1 gap-x-8 gap-y-6">
            <div>
              <label
                for="name"
                class="block text-sm font-semibold leading-6 text-gray-900"
              >
                이름 *
              </label>
              <input
                type="text"
                name="name"
                id="name"
                placeholder="John Doe"
                class="focus:ring-primary mt-2.5 block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
                required
              />
            </div>
            <div>
              <label
                for="email"
                class="block text-sm font-semibold leading-6 text-gray-900"
              >
                이메일 *
              </label>
              <input
                type="email"
                name="email"
                id="email"
                autocomplete="email"
                placeholder="john@email.com"
                class="focus:ring-primary mt-2.5 block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
                required
              />
            </div>
            <div>
              <label
                for="phone"
                class="block text-sm font-semibold leading-6 text-gray-900"
              >
                전화번호 *
              </label>
              <input
                type="tel"
                name="phone"
                id="phone"
                autocomplete="tel"
                 placeholder="010-1234-5678"
                class="focus:ring-primary mt-2.5 block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
                required
              />
            </div>
            <div>
              <label
                for="grade"
                class="block text-sm font-semibold leading-6 text-gray-900"
              >
                현재 학년 *
              </label>
              <input
                type="text"
                name="grade"
                id="grade"
                placeholder="9학년"
                class="focus:ring-primary mt-2.5 block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
                required
              />
            </div>
            <div>
              <label
                for="program-name"
                class="block text-sm font-semibold leading-6 text-gray-900"
              >
                관심 프로그램
              </label>
              <select
                id="program-name"
                name="program-name"
                class="focus:ring-primary mt-2.5 block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
                required
              >
                <option value="">프로그램을 선택해주세요</option>
                <option value="Tutor Service Online/Offline">Tutor Service Online/Offline</option>
                <option value="Summer/Winter Camp">Summer/Winter Camp</option>
                <option value="Undergraduate Admissions Consulting">Undergraduate Admissions Consulting</option>
                <option value="MBA Admissions Consulting">MBA Admissions Consulting</option>
              </select>
            </div>
            <div>
              <label
                for="message"
                class="block text-sm font-semibold leading-6 text-gray-900"
              >
                문의사항
              </label>
              <textarea
                name="message"
                id="message"
                rows="4"
                placeholder="문의하실 내용을 입력해주세요..."
                class="focus:ring-primary mt-2.5 block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
                required></textarea>
            </div>
          </div>
          <div class="mt-8 flex justify-end">
            <button
              type="submit"
              class="rounded-md bg-black px-6 py-3 text-sm font-semibold text-white shadow-sm hover:bg-gray-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-black"
            >
              문의하기
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  import toast from 'react-hot-toast';
  
  const form = document.getElementById('contactForm');
  
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    try {
      const res = await fetch('/api/contact', {
        method: 'POST',
        body: new FormData(e.target as HTMLFormElement)
      });
      
      const data = await res.json();
      
      if (res.ok) {
        toast.success('메시지가 성공적으로 전송되었습니다.');
        (e.target as HTMLFormElement).reset();
      } else {
        toast.error('메시지 전송에 실패했습니다.');
      }
    } catch (err) {
      toast.error('오류가 발생했습니다. 다시 시도해주세요.');
      console.error(err);
    }
  });
</script>
